meta {
  name: Aspire Dashboard Info
  type: http
  seq: 2
}

get {
  url: https://localhost:15888/api/v1/resources
  body: none
  auth: none
}

headers {
  Accept: application/json
}

script:post-response {
  if (res.status === 200) {
    const resources = res.getBody();
    console.log("ğŸ“Š Aspire Dashboard - Resources:");
    console.log("=================================");
    
    if (Array.isArray(resources)) {
      resources.forEach(resource => {
        const icon = getResourceIcon(resource.resourceType);
        const status = resource.state || "Unknown";
        const statusIcon = status === "Running" ? "ğŸŸ¢" : 
                          status === "Starting" ? "ğŸŸ¡" : 
                          status === "Stopped" ? "ğŸ”´" : "âšª";
        
        console.log(`${icon} ${resource.name}`);
        console.log(`   ${statusIcon} Status: ${status}`);
        console.log(`   ğŸ·ï¸  Type: ${resource.resourceType}`);
        
        if (resource.endpoints && resource.endpoints.length > 0) {
          console.log(`   ğŸ”— Endpoints:`);
          resource.endpoints.forEach(endpoint => {
            console.log(`      â€¢ ${endpoint.endpointUrl}`);
          });
        }
        console.log("");
      });
    }
    
    console.log("ğŸ”— Dashboard URL: https://localhost:15888");
  } else {
    console.log("âŒ Failed to get Aspire Dashboard info");
    console.log("ğŸ’¡ Make sure Aspire is running:");
    console.log("   dotnet run --project src/Aspire/MeAjudaAi.AppHost");
  }
  
  function getResourceIcon(type) {
    switch(type) {
      case "postgres": return "ğŸ˜";
      case "redis": return "ğŸ—ƒï¸";
      case "rabbitmq": return "ğŸ°";
      case "keycloak": return "ğŸ”";
      case "container": return "ğŸ³";
      case "project": return "ğŸš€";
      default: return "ğŸ“¦";
    }
  }
}

docs {
  # Aspire Dashboard Info
  
  ObtÃ©m informaÃ§Ãµes sobre todos os recursos gerenciados pelo Aspire.
  
  ## O que mostra
  - ğŸš€ **Projetos**: APIs e serviÃ§os .NET
  - ğŸ³ **Containers**: PostgreSQL, Redis, RabbitMQ, Keycloak
  - ğŸ”— **Endpoints**: URLs de acesso aos serviÃ§os
  - ğŸ“Š **Status**: Running, Starting, Stopped
  
  ## PrÃ©-requisitos
  - Aspire Dashboard rodando em https://localhost:15888
  - Certificado SSL aceito no navegador
  
  ## Resposta Esperada
  ```json
  [
    {
      "name": "postgres-local",
      "resourceType": "postgres",
      "state": "Running",
      "endpoints": [
        {
          "endpointUrl": "postgresql://localhost:5432"
        }
      ]
    },
    {
      "name": "apiservice",
      "resourceType": "project", 
      "state": "Running",
      "endpoints": [
        {
          "endpointUrl": "http://localhost:5000"
        }
      ]
    }
  ]
  ```
  
  ## CÃ³digos de Status
  - **200**: Dashboard disponÃ­vel e funcionando
  - **404**: Endpoint nÃ£o encontrado (versÃ£o Aspire diferente?)
  - **Connection Error**: Aspire nÃ£o estÃ¡ rodando
  
  ## Uso
  - VerificaÃ§Ã£o rÃ¡pida do status dos serviÃ§os
  - Descoberta de endpoints dinÃ¢micos
  - Debugging de problemas de conectividade
  
  ## Troubleshooting
  
  ### Connection refused:
  1. Verifique se Aspire estÃ¡ rodando:
     ```bash
     dotnet run --project src/Aspire/MeAjudaAi.AppHost
     ```
  2. Acesse manualmente: https://localhost:15888
  
  ### SSL Certificate error:
  1. Abra https://localhost:15888 no navegador
  2. Aceite o certificado self-signed
  3. Execute novamente este endpoint
  
  ### API endpoint changed:
  - API pode variar entre versÃµes do Aspire
  - Consulte documentaÃ§Ã£o da versÃ£o especÃ­fica
}